checks:
  input:
    path: 'var/log/kern.log'
  has_stacktraces:
    property:
      path: hotsos.core.plugins.kernel.CallTraceManager.calltrace_anytype
      ops: [[length_hint]]
  has_oom_killer_invoked:
    property:
      path: hotsos.core.plugins.kernel.CallTraceManager.oom_killer
      ops: [[length_hint]]
conclusions:
  stacktraces:
    # Give this one lowest priority so that if any other call trace types match they
    # take precedence.
    priority: 1
    decision: has_stacktraces
    raises:
      type: KernelError
      message: >-
        {numreports} reports of stacktraces in kern.log - please check.
      format-dict:
        numreports: '@checks.has_stacktraces.requires.value_actual:len'
  oom-killer-invoked:   
    priority: 2
    decision: has_oom_killer_invoked
    raises:
      type: MemoryWarning
      message: >-
        {numreports} reports of oom-killer invoked in kern.log - please check.
      format-dict:
        numreports: '@checks.has_oom_killer_invoked.requires.value_actual:len'
