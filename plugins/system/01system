#!/bin/bash -u
# This plugin displays system-specific information. Note that this is not
# intended to supersceded information from tools like xsos.

echo "system:"

data_source=uptime
if [ -r "$data_source" ]; then
    data_source2=sos_commands/processor/lscpu
    if [ -r "$data_source2" ]; then
        NUM_CPUS=$(grep -P '^CPU\(s\):' sos_commands/processor/lscpu | awk -F' ' '{print $2}')
    fi

    sed -r "s/.+(load average)(:.+)/- \1 ($NUM_CPUS cpus)\2/g" $data_source|xargs -l -I{} echo "  {}"
else
    echo "  $data_source not found"
fi

data_source=df
if [ -r "$data_source" ]; then
    echo "${INDENT_STR}rootfs: `egrep ' /$' $data_source`"
else
    echo "  $data_source not found"
fi

