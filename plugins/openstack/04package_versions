#!/usr/bin/python3
import re
import os

from common import helpers

from openstack_common import OST_PROJECTS

# HOTSOS GLOBALS
VERBOSITY_LEVEL = int(os.environ.get('VERBOSITY_LEVEL', 0))
DATA_ROOT = os.environ.get('DATA_ROOT', '/')

OST_DEPS = [
    r"conntrack",
    r"dnsmasq",
    r"haproxy",
    r"keepalived",
    r"libc-bin",
    r"libvirt-daemon",
    r"libvirt-bin",
    r"python3?-oslo[.-]",
    r"openvswitch-switch",
    r"ovn",
    r"qemu-kvm",
]

dep_list = OST_PROJECTS + OST_DEPS
if helpers.get_dpkg_l():
    print("  dpkg:")
    for line in helpers.get_dpkg_l():
        for dep in dep_list:
            ret = re.compile(r"^ii\s+({}[0-9a-z\-]*)\s+(\S+)\s+.+"
                             .format(dep)).match(line)
            if ret:
                print("    - {} {}".format(ret[1], ret[2]))
